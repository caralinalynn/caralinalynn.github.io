---
title: "Environmental Impacts of Corporations"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    source_code: embed
    version: 4
    theme:
      bootswatch: lux
---

<style>
.chart-title { /* chart_title */
  font-size: 16px;
  }
body{ /* Normal */ 
      font-size: 14px;
  }
</style>

```{r setup, include=FALSE}
library(flexdashboard)
pacman::p_load(circlize, chorddiag, DT, knitr, plotly, tidyverse, readxl, cluster, factoextra)
eci <- read.csv("D:/Classwork/Year 3/MTH 208/project/Corporate-Environmental-Impact-Data-2020cleaned.csv")
glimpse(eci)  
```

Introduction 
===

Column {.tabset data-width=500}
-----------------------------------------------------------------------

### Introduction

I am a paragraph

### Methodology

Column {.tabset data-width=500}
-----------------------------------------------------------------------

### Impact Factors

```{r}

```

### UN SDG

```{r}

```

Data1 
===

Column {data-width=500}
-----------------------------------------------------------------------

### Chart A

```{r}

```

Column {data-width=500}
-----------------------------------------------------------------------

### Chart B

```{r}

```

Clustering 
===

Column {.tabset data-width=500}
-----------------------------------------------------------------------

### Chart A

```{r}
ecic <- subset(eci[,10:11])
clust <- na.omit(ecic)

ecic$Working.Capacity <- as.numeric(as.factor(ecic$Working.Capacity))
ecic$Total.Environmental.Cost <- as.numeric(as.factor(ecic$Total.Environmental.Cost))
kmeans_result <- kmeans(ecic,
centers = 4,
nstart = 20)

plot(ecic[,1], ecic[,2],
     col = kmeans_result$cluster,
     pch = 19) -> x
points(kmeans_result$centers[,1], kmeans_result$centers[,2],
       col = 1:4, pch = 8, cex = 2)


```


### Chart B

```{r}
ecib <- eci[, c("EnvironmentalIntensitySalesFinal", "Biodiversity")]
clust <- na.omit(ecib)

ecib$EnvironmentalIntensitySalesFinal <- as.numeric(as.factor(ecib$EnvironmentalIntensitySalesFinal))
ecib$Biodiversity <- as.numeric(gsub(",","", ecib$Biodiversity))

kmeans_result <- kmeans(ecib,
centers = 2,
nstart = 20)

plot(ecib[,1], ecib[,2],
     col = kmeans_result$cluster,
     pch = 19) -> x
points(kmeans_result$centers[,1], kmeans_result$centers[,2],
       col = 1:4, pch = 8, cex = 2)

```

Column {.tabset data-width=500}
-----------------------------------------------------------------------

### Hierarchial 1

```{r}
ecix <- subset(eci[,9:10])
clust <- na.omit(ecic)

ecix$EnvironmentalIntensityOpInc <- as.numeric(as.factor(ecix$EnvironmentalIntensityOpInc))
ecix$Total.Environmental.Cost <- as.numeric(as.factor(ecix$Total.Environmental.Cost))

r <- dist(ecix)

hcr <- hclust(r, method = "complete")

plot(hcr, labels = FALSE, hang = -1,
main = "Hierarchical Clustering Dendrogram")

```

### Hierarchial 2

```{r}
d <- dist(ecib)

hc <- hclust(d, method = "complete")

plot(hc, labels = FALSE, hang = -1,
main = "Hierarchical Clustering Dendrogram")
```


Maps 
===

Column {.tabset data-width=1000}
-----------------------------------------------------------------------

### Sales

<div class='tableauPlaceholder' id='viz1713364225541' style='position: relative'>
<noscript><a href='#'><img alt='Sum of Environmental Intensity (Sales)  ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;SH&#47;SHYBQ85TG&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='path' value='shared&#47;SHYBQ85TG' /> <param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;SH&#47;SHYBQ85TG&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /><param name='filter' value='publish=yes' /></object>
</div>                

```{js, embedcode, echo = FALSE}
var divElement = document.getElementById('viz1713364225541');                    
var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    
scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                
```

### Cost

<div class='tableauPlaceholder' id='viz1713365365240' style='position: relative'><noscript><a href='#'><img alt='Sum of Environmental Cost ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;ma&#47;mapping_17133640716610&#47;EnvCost&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='mapping_17133640716610&#47;EnvCost' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;ma&#47;mapping_17133640716610&#47;EnvCost&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /></object></div> 

```{js, map2, embedcode, echo = FALSE}
                   var divElement = document.getElementById('viz1713365365240');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='100%';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);               
```




Summary 
===

Column {data-width=500}
-----------------------------------------------------------------------

### Chart A

```{r}

```

Column {data-width=500}
-----------------------------------------------------------------------

### Chart B

```{r}

```

References
===

Column {data-width=500}
---

```{r}

```


Author 
===

Column {data-width=500}
-----------------------------------------------------------------------

### Hello

Caralina Lynn Crouch is a chemistry study at the University of Dayton. She is 
also pursuing a Data Analytics minor and is a member of the Dayton Civic Scholars 
2025 Cohort. Her interests include exploring the overlap of science and community
while also keeping her artist identity in mind. 

You can keep up to date with her on [LinkedIn](https://www.linkedin.com/in/caralina-lynn-crouch-8015a8249/).

Column {data-width=500}
-----------------------------------------------------------------------

### 

![](D:/Classwork/Year 3/MTH 209/Final Project/small.jpg) 

